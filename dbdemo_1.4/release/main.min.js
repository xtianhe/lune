var ElementData=function(){function t(){this.id="",this.icon="",this.resNames=null,this.type=""}var e=(__define,t);e.prototype;return t}();egret.registerClass(ElementData,"ElementData");var SkinData=function(){function t(){this._eleData=null,this._groupData=null,this._allData=null}var e=__define,n=t,i=n.prototype;return i.setEleData=function(t){this._eleData=t},e(i,"eleData",function(){return this._eleData}),i.setGroupData=function(t){this._groupData=t},e(i,"groupData",function(){return this._groupData}),i.setAllData=function(t){this._allData=t},e(i,"allData",function(){return this._allData}),i.getResNamesDataByID=function(t){for(var e=this._eleData.length,n=0;e>n;n++)if(this._eleData[n].id==t)return this._eleData[n].resNames;return null},i.getEleDataByType=function(t){if("all"==t)return this._allData;for(var e=[],n=this._eleData.length,i=0;n>i;i++)this._eleData[i].type==t&&e.push(this._eleData[i]);return e},i.getResNamesDataByIDWithAll=function(t){for(var e,n=this._allData.length,i=0;n>i;i++)if(this._allData[i].id==t){e=this._allData[i].resNames;break}var s=[];n=e.length;for(var i=0;n>i;i++)s.push(this.getResNamesDataByID(e[i]));return s},t}();egret.registerClass(SkinData,"SkinData");var SkinParse=function(){function t(){}var e=(__define,t);e.prototype;return t.parse=function(e,n){t.parseEles(e.eles,n),t.parseAll(e.all,n),t.parseGroup(e.group,n)},t.parseEles=function(t,e){for(var n=[],i=t.length,s=0;i>s;s++){var a=new ElementData;a.id=t[s].id,a.type=t[s].type,a.icon=t[s].icon,a.resNames=t[s].resNames,n.push(a)}e.setEleData(n)},t.parseAll=function(t,e){for(var n=[],i=t.length,s=0;i>s;s++){var a=new ElementData;a.id=t[s].id,a.icon=t[s].icon,a.resNames=t[s].resNames,a.type="all",n.push(a)}e.setAllData(n)},t.parseGroup=function(t,e){for(var n=[],i=t.length,s=0;i>s;s++){var a=new ElementData;a.id=t[s].id,a.icon=t[s].icon,a.type=t[s].type,n.push(a)}e.setGroupData(n)},t}();egret.registerClass(SkinParse,"SkinParse");var Logic=function(){function t(){this._pm=null,this._skinData=null,this._scene=null}var e=(__define,t),n=e.prototype;return n.start=function(t){this.createSkinData(),this.createPeople(),this.createScene(t),this.createMessageListener()},n.createPeople=function(){this._pm=new PeopleManage},n.createSkinData=function(){this._skinData=new SkinData,SkinParse.parse(RES.getRes("ele_json"),this._skinData)},n.createScene=function(t){this._scene=new Scene,t.addChild(this._scene),this._scene.renderScene(),this._scene.setPeople(this._pm.display),this._scene.setGroupData(this._skinData.groupData),this._scene.setAllData(this._skinData.getEleDataByType("all"))},n.createMessageListener=function(){MessageCenter.getInstance().addEventListener(MessageCenter.CHANGE_UI_GROUP,this.changeGroupData,this),MessageCenter.getInstance().addEventListener(MessageCenter.CHANGE_PEOPLE_ELEMENT,this.changePeopleElement,this)},n.changeGroupData=function(t){"all"==t.data?this._scene.setAllData(this._skinData.getEleDataByType(t.data)):this._scene.setElesData(this._skinData.getEleDataByType(t.data))},n.changePeopleElement=function(t){var e=t.data;switch(e.type){case"head":this._pm.setHead(this._skinData.getResNamesDataByID(e.id));break;case"cloth":this._pm.setCloth(this._skinData.getResNamesDataByID(e.id));break;case"pants":this._pm.setPants(this._skinData.getResNamesDataByID(e.id));break;case"shoe":this._pm.setShoe(this._skinData.getResNamesDataByID(e.id));break;case"all":this._pm.setAll(this._skinData.getResNamesDataByIDWithAll(e.id))}},t}();egret.registerClass(Logic,"Logic");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},i.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},i.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},i.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},i.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},i.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},i.createGameScene=function(){this._logic=new Logic,this._logic.start(this)},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var Scene=function(t){function e(){t.call(this),this._borderSpace=15,this._typeBannerBackGround=null,this._checkGroupButton=null,this._elementLayer=null,this._allEleCheckGroupButton=null,this._eleCheckGroupButton=null}__extends(e,t);var n=(__define,e),i=n.prototype;return i.renderScene=function(){this.createBackGround(),this.createButtons(),this.createTypeBannerBg()},i.setPeople=function(t){t.x=230,t.y=250;var e=200/t.height;t.scaleX=e,t.scaleY=e,this.addChild(t)},i.createBackGround=function(){var t=new egret.Bitmap;t.texture=RES.getRes("shiyijianbeijing_png"),t.x=(this.stage.stageWidth-t.width)/2,t.y=-220,this.addChild(t)},i.createButtons=function(){var t=new Button;t.setSkin("fanhui_png","fanhui_0_png"),t.x=0,t.y=0,this.addChild(t);var e=new egret.Bitmap;e.texture=RES.getRes("shuzidiban_png"),e.x=280,e.y=0,this.addChild(e);var n=new egret.Bitmap;n.texture=RES.getRes("zuanshi_png"),n.x=300,n.y=25,this.addChild(n);var i=new egret.TextField;i.textColor=0,i.text="2008",i.x=360,i.y=30,this.addChild(i);var s=new Button;s.setSkin("gouwu_png","gouwu_0_png"),s.x=(this.stage.stageWidth-s.width)/2,s.y=700,this.addChild(s)},i.createTypeBannerBg=function(){this._typeBannerBackGround=new egret.Bitmap,this._typeBannerBackGround.texture=RES.getRes("xitongtubiaodiban_png"),this._typeBannerBackGround.width=this.stage.stageWidth-2*this._borderSpace,this._typeBannerBackGround.x=this._borderSpace,this._typeBannerBackGround.y=340,this.addChild(this._typeBannerBackGround),this.createElementLayer()},i.setGroupData=function(t){this._checkGroupButton=new CheckGroupButton,this._checkGroupButton.groupWidth=this._typeBannerBackGround.width-2*this._borderSpace,this._checkGroupButton.setSkin("","tubiaoxuanzhong_png"),this._checkGroupButton.addData(t),this._checkGroupButton.display.x=this._typeBannerBackGround.x+this._borderSpace,this._checkGroupButton.display.y=this._typeBannerBackGround.y+10,this.addChild(this._checkGroupButton.display)},i.createElementLayer=function(){this._elementLayer=new egret.DisplayObjectContainer,this._elementLayer.x=this._typeBannerBackGround.x,this._elementLayer.y=this._typeBannerBackGround.y+this._typeBannerBackGround.height+10,this.addChild(this._elementLayer)},i.setAllData=function(t){this._allEleCheckGroupButton=new AllElementCheckGroupButton,this._allEleCheckGroupButton.groupWidth=this._typeBannerBackGround.width,this._allEleCheckGroupButton.setSkin("","xuanzhong2_png"),this._allEleCheckGroupButton.addData(t),this._elementLayer.removeChildren(),this._elementLayer.addChild(this._allEleCheckGroupButton.display)},i.setElesData=function(t){this._eleCheckGroupButton=new ElementCheckGroupButton,this._eleCheckGroupButton.groupWidth=this._typeBannerBackGround.width,this._eleCheckGroupButton.setSkin("","xuanzhong_png"),this._eleCheckGroupButton.addData(t),this._elementLayer.removeChildren(),this._elementLayer.addChild(this._eleCheckGroupButton.display)},e}(egret.DisplayObjectContainer);egret.registerClass(Scene,"Scene");var CheckGroupButton=function(){function t(){this._checkBtns=null,this._unSkinName="",this._checkSkinName="",this.groupWidth=0,this._space=0,this._display=null,this._currentCheckButton=null,this._checkBtns=[],this._display=new egret.DisplayObjectContainer}var e=__define,n=t,i=n.prototype;return i.setSkin=function(t,e){this._unSkinName=t,this._checkSkinName=e},i.addData=function(t){for(var e=t.length,n=0;e>n;n++){var i=new CheckButton;i.setSkin(this._unSkinName,this._checkSkinName),i.setContext(t[n].icon),i.ID=t[n].id,i.TYPE=t[n].type,this._checkBtns.push(i),this._display.addChild(i),i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.checkBtnClick,this)}this._checkBtns[0].isCheck=!0,this._currentCheckButton=this._checkBtns[0],this.arrange()},i.arrange=function(){var t=this._checkBtns.length;this._space=(this.groupWidth-this._checkBtns[0].width*t)/(t+1);for(var e=this._space+this._checkBtns[0].width,n=0;t>n;n++)this._checkBtns[n].arrange(),this._checkBtns[n].x=e*n},e(i,"display",function(){return this._display}),i.checkBtnClick=function(t){this._currentCheckButton!=t.currentTarget&&(this._currentCheckButton&&(this._currentCheckButton.isCheck=!1),this._currentCheckButton=t.currentTarget,this.sendMessage(t.currentTarget.ID,t.currentTarget.TYPE))},i.sendMessage=function(t,e){MessageCenter.getInstance().sendMessage(MessageCenter.CHANGE_UI_GROUP,e)},t}();egret.registerClass(CheckGroupButton,"CheckGroupButton");var AllElementCheckGroupButton=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.addData=function(t){for(var e=t.length,n=0;e>n;n++){var i=new ElementCheckButton;i.setSkin(this._unSkinName,this._checkSkinName),i.setContext(t[n].icon),i.setBackground("fuzhuangge_png"),i.ID=t[n].id,i.TYPE=t[n].type,this._checkBtns.push(i),this._display.addChild(i),i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.checkBtnClick,this)}this.arrange()},i.arrange=function(){var t=this._checkBtns.length;if(0!=t)for(var e=(this.groupWidth-3*this._space)/4,n=0;t>n;n++)this._checkBtns[n].setScale(e),this._checkBtns[n].arrange(),this._checkBtns[n].x=n%4*(e+this._space)},i.sendMessage=function(t,e){MessageCenter.getInstance().sendMessage(MessageCenter.CHANGE_PEOPLE_ELEMENT,{id:t,type:e})},e}(CheckGroupButton);egret.registerClass(AllElementCheckGroupButton,"AllElementCheckGroupButton");var Button=function(t){function e(){t.call(this),this._upSkin=null,this._downSkin=null,this.touchEnabled=!0}__extends(e,t);var n=(__define,e),i=n.prototype;return i.setSkin=function(t,e){this._upSkin=new egret.Bitmap,this._upSkin.texture=RES.getRes(t),this._downSkin=new egret.Bitmap,this._downSkin.texture=RES.getRes(e),this.renderSkin()},i.renderSkin=function(){this.addChild(this._upSkin),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchDown,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.touchUp,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchUp,this)},i.touchDown=function(t){this.removeChild(this._upSkin),this.addChild(this._downSkin)},i.touchUp=function(t){this.removeChild(this._downSkin),this.addChild(this._upSkin)},e}(egret.DisplayObjectContainer);egret.registerClass(Button,"Button");var CheckButton=function(t){function e(){t.call(this),this.ID="",this.TYPE="",this._isCheck=!1,this._skinBitmap=null,this._unSkinTexture=null,this._checkSkinTexture=null,this.initSkin(),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.click,this)}__extends(e,t);var n=__define,i=e,s=i.prototype;return n(s,"isCheck",function(){return this._isCheck},function(t){this._isCheck=t,this.change()}),s.setSkin=function(t,e){this._unSkinTexture=RES.getRes(t),this._checkSkinTexture=RES.getRes(e)},s.initSkin=function(){this.initSkinBitmap(),this.initContext()},s.initSkinBitmap=function(){this._skinBitmap=new egret.Bitmap,this._skinBitmap.texture=this._unSkinTexture,this.addChild(this._skinBitmap)},s.initContext=function(){this._context=new egret.Bitmap,this.addChild(this._context)},s.setContext=function(t){this._context.texture=RES.getRes(t)},s.arrange=function(){this._context.x=(this._checkSkinTexture.textureWidth-this._context.width)/2,this._context.y=(this._checkSkinTexture.textureHeight-this._context.height)/2},s.setSize=function(t){this._skinBitmap.width=t,this._skinBitmap.height=t,this._context.width=t-10,this._context.height=t-10},s.setScale=function(t){var e=t/this._skinBitmap.width;this._skinBitmap.scaleX=e,this._skinBitmap.scaleY=e,this._context.scaleX=e,this._context.scaleY=e},s.change=function(){this._isCheck?this._skinBitmap.texture=this._checkSkinTexture:this._skinBitmap.texture=this._unSkinTexture},s.click=function(t){0==this._isCheck&&(this._isCheck=!0,this.change())},e}(egret.DisplayObjectContainer);egret.registerClass(CheckButton,"CheckButton");var ElementCheckButton=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.initSkin=function(){this.initBackground(),this.initContext(),this.initSkinBitmap()},i.initBackground=function(){this._backGroundBitmap=new egret.Bitmap,this.addChild(this._backGroundBitmap)},i.setBackground=function(t){console.log(this._backGroundBitmap),this._backGroundBitmap.texture=RES.getRes(t)},i.setSize=function(t){this._backGroundBitmap.width=t,this._backGroundBitmap.height=t,this._skinBitmap.width=t,this._skinBitmap.height=t,this._context.width=t-10,this._context.height=t-10},i.arrange=function(){this._context.x=(this._skinBitmap.width-this._context.width)/2,this._context.y=(this._skinBitmap.height-this._context.height)/2},i.setScale=function(t){var e=t/this._checkSkinTexture.textureWidth,n=this._checkSkinTexture.textureWidth*e,i=this._checkSkinTexture.textureHeight*e;this._backGroundBitmap.width=n,this._backGroundBitmap.height=i,this._skinBitmap.width=n,this._skinBitmap.height=i},e}(CheckButton);egret.registerClass(ElementCheckButton,"ElementCheckButton");var ElementCheckGroupButton=function(t){function e(){t.call(this),this._space=5}__extends(e,t);var n=(__define,e),i=n.prototype;return i.addData=function(t){for(var e=t.length,n=0;e>n;n++){var i=new ElementCheckButton;i.setSkin(this._unSkinName,this._checkSkinName),i.setContext(t[n].icon),i.setBackground("wupinge_png"),i.ID=t[n].id,i.TYPE=t[n].type,this._checkBtns.push(i),this._display.addChild(i),i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.checkBtnClick,this)}this.arrange()},i.arrange=function(){var t=this._checkBtns.length;if(0!=t)for(var e=(this.groupWidth-3*this._space)/4,n=0;t>n;n++)this._checkBtns[n].setSize(e),this._checkBtns[n].arrange(),this._checkBtns[n].x=n%4*(e+this._space),this._checkBtns[n].y=Math.floor(n/4)*(e+this._space)},i.sendMessage=function(t,e){MessageCenter.getInstance().sendMessage(MessageCenter.CHANGE_PEOPLE_ELEMENT,{id:t,type:e})},e}(CheckGroupButton);egret.registerClass(ElementCheckGroupButton,"ElementCheckGroupButton");var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var n=(__define,e),i=n.prototype;return i.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center",this.textField.textColor=0},i.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var PeopleManage=function(){function t(){this._armature=null,this.init()}var e=__define,n=t,i=n.prototype;return i.init=function(){var t=RES.getRes("man_json"),e=RES.getRes("texture_json"),n=RES.getRes("texture_png"),i=new dragonBones.EgretFactory;i.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(t)),i.addTextureAtlas(new dragonBones.EgretTextureAtlas(n,e));var s=i.buildArmature("man");s.animation.gotoAndPlay("runFront",0,-1,0),dragonBones.WorldClock.clock.add(s),this._armature=s,egret.startTick(this.dbrun,this)},i.dbrun=function(t){return dragonBones.WorldClock.clock.advanceTime(.01),!0},e(i,"display",function(){return this._armature.display}),i.setHead=function(t){this.setNewSlot("Atoufa",t[0])},i.setCloth=function(t){this.setNewSlot("Ayifu",t[0]),this.setNewSlot("Axiuzi11",t[1]),this.setNewSlot("Axiuzi21",t[2]),this.setNewSlot("Axiuzi12",t[3]),this.setNewSlot("Axiuzi22",t[4])},i.setPants=function(t){this.setNewSlot("Akuzi",t[0]),this.setNewSlot("Akuzi12",t[1]),this.setNewSlot("Akuzi22",t[2]),this.setNewSlot("Akuzi11",t[3]),this.setNewSlot("Akuzi21",t[4])},i.setShoe=function(t){this.setNewSlot("Axiezi1",t[0]),this.setNewSlot("Axiezi2",t[1])},i.setAll=function(t){this.setHead(t[0]),this.setCloth(t[1]),this.setPants(t[2]),this.setShoe(t[3])},i.setNewSlot=function(t,e){var n=this._armature.getSlot(t),i=new egret.Bitmap;i.texture=RES.getRes(e),i.x=n.display.x,i.y=n.display.y,i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,n.setDisplay(i)},t}();egret.registerClass(PeopleManage,"PeopleManage");var MessageCenter=function(t){function e(){if(e._isInit)throw new Error("MessageCenter为单例模式，请使用 MessageCenter.getInstance()获取实例！");t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return e.getInstance=function(){return null==e._this&&(e._isInit=!1,e._this=new e,e._isInit=!0),e._this},i.sendMessage=function(t,e){var n=new egret.Event(t);n.data=e,this.dispatchEvent(n)},e.CHANGE_UI_GROUP="changeUIGroup",e.CHANGE_PEOPLE_ELEMENT="changePeopleElement",e._this=null,e._isInit=!0,e}(egret.EventDispatcher);egret.registerClass(MessageCenter,"MessageCenter");