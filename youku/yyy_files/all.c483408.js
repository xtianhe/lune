!function(e){function t(e){var t={};return e.split("&").forEach(function(e){var n=e.indexOf("=");n>0&&(t[e.substring(0,n)]=decodeURIComponent(e.substring(n+1)))}),t}function n(e,t,n){for(var i in t)(!n||n.indexOf(i)>-1)&&(e[i]=t[i])}function i(e){var t=document.cookie.match(RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=t?unescape(t[2]):null}function o(e,t){var n=[];for(key in e)t?n.push(key+"="+e[key]):n.push(encodeURIComponent(key)+"="+encodeURIComponent(e[key]));return n.join("&")}function a(){var e=t(location.search.substring(1)),o={ua:W},a=i("__ysuid");return n(o,e,["refer","tuid"]),a&&(o.cookieid=a+"|"+O.uuid(6)),o}function s(e,t,n){var i=encodeURIComponent("http://"+location.host+location.pathname+location.search+location.hash+"&noapp=1"),a="youku://play?"+o(e,q),s="intent://play?"+o(e,!1)+"#Intent;scheme=youku;package=com.youku.phone.xxx;S.browser_fallback_url="+i+";end;",c=function(e){var t="undefined"==typeof document.hidden?"webkitvisibilitychange":"visibilitychange",n=setTimeout(function(){r(function(t){e({websocket:t})})},1e3),i=function(){e({hidden:!0}),document.removeEventListener(t,i),clearTimeout(n)};document.addEventListener(t,i)},u=function(e){var t=document.createElement("iframe");t.width=0,t.height=0,document.body.appendChild(t),t.src=e};c(function(e){return e.hidden?void t():void(e.websocket?t():n())}),A&&V>"25"&&!E?location.href=s:I?location.href=a:u(a)}function r(t){if(!("WebSocket"in e))return void t(!1);var n=new WebSocket("ws://127.0.0.1:51200"),i=setTimeout(function(){n.onerror=null,t(!1)},1e3);n.onopen=function(){this.close(),clearTimeout(i),t(!0)},n.onerror=function(){clearTimeout(i),t(!1)}}function c(e){return atob(e.substring(1))>>2}function u(e,t){return t+btoa(parseInt(e)<<2)}function l(){x?v?location.href="http://a.app.qq.com/o/simple.jsp?pkgname=com.youku.phone&g_f=992258":location.href="http://dl.m.cc.youku.com/android/phone/Youku_Android_yidongbanner.apk":q?v?location.href="http://a.app.qq.com/o/simple.jsp?pkgname=com.youku.phone&g_f=992258":location.href="https://itunes.apple.com/cn/app/you-ku-shi-pin-zhong-guo-zhi/id336141475?l=en&mt=8":D.flash('请在应用商店内搜索"优酷视频"下载')}function h(e,t){var i={img_url:"http://static.youku.com/pl-static/h5/youkologo_300x300.png",img_width:640,img_height:640,link:location.href};n(i,t),"object"==typeof WeixinJSBridge&&WeixinJSBridge.invoke(e?"sendAppMessage":"shareTimeline",i,function(e){})}function d(e){x&&$("#player video").css({visibility:e?"visible":"hidden"})}function p(t){M||(M=new Vue({el:"#leaving-page",data:{leaving:!0}}),e.addEventListener("pageshow",function(){M.leaving=!1,$("#leaving-page").hide()})),M.leaving=!t,$("#leaving-page").css({display:t?"none":"table"})}function m(e,t){var n=document.createElement("div");n.innerHTML=e;for(var i=n.querySelectorAll(".comment-item"),o=[],a=0;a<i.length&&!(a>=t);a++){var s=i[a];o.push({avatar:s.querySelector("img").src,time:s.querySelector(".item-time").innerText.trim(),name:s.querySelector(".item-name").innerText.trim(),comment:s.querySelector("p").innerText.trim()})}return o}var f=navigator.userAgent,v=/MicroMessenger/.test(f),g=/Weibo/.test(f),y=/UCBrowser/.test(f),w=/QQ\//.test(f),k=/Qzone/.test(f),b=/MQQBrowser/.test(f)||w,x=/Android/.test(f),I=/OS 9_/.test(f),q=/iPhone|iPod/.test(f),S=/LieBao/.test(f),_=/360 Aphone Browser/.test(f),C=g||v||b,T=x&&!v&&C,j=!v&&(I||!C),A=(x&&/Android ([0-9.]+)/.exec(f)[1],/Chrome\//.test(f)),E=S||_,V=A&&/Chrome\/([0-9.]+)/.exec(f)[1],W=function(){return v?"wechat":g?"weibo":y?"uc":"other"}(),z=console,L={info:function(){var e=Array.prototype.slice.call(arguments);e.splice(0,0,"background: green; color: white; padding: 0 3px; border-radius: 3px;"),e.splice(0,0,"%cinfo"),z.log.apply(z,e)}};e.Debug=L;var M,B={el:"player",defaultConfig:{},create:function(e,t){var i={vid:e,prefer:"h5",expand:0,canWide:0,paid:0,client_id:"youkumobileplaypage",wintype:"interior",autoplay:!1,auto:0,weixin:v};n(i,this.defaultConfig),this.player&&this.player.pauseVideo(),this.player=new YKU.Player(this.el,i);var o=document.querySelector("#"+this.el+" video");t&&(o.load(),o.play())}},O={chars:"0123456789abcdefghijklmnopqrstuvwxyz",uuid:function(e){for(var t=this.chars.length,n=[],i=0;e>i;i++)n.push(this.chars[parseInt(Math.random()*t)]);return n.join("")}};e.L=p;var R={params:{tp:1,cpp:1000974},events:{pageReady:[4010880,4010863],install:[4010879,0],play:[4010878,4010862],shareXXL:[4010877,0],shareWeixin:[4010876,4010857],shareQQ:[4010875,4010856],shareQZone:[4010874,4010855],shareWeibo:[4010873,4010854],follow:[4010872,4010860],followSuccess:[4010871,4010859],nextVideo:[4010870,4010853],viewAllVideos:[4010869,4010852],writeComment:[4010868,4010851],writeCommentSuccess:[4010867,4010850],viewComments1:[4010866,0],viewComments2:[4010865,0],weixinAccount:[4010864,0],launchComments:[0,4010849],shareXXS:[0,4010858],launchXXL:[0,4010861],visitUser:[4010886,4010887]},defer:function(e,t){return function(){var n={},i=setTimeout(function(){n.timeout=!0,e()},t);return function(){clearTimeout(i),n.timeout||e()}}()},t:function(e,t){var i=this.events[e];if(!i)return void console.error("No tracking code for event",e);var a=i[+this.launchable];if(a){var s=new Image,r={cp:a};n(r,this.params),t&&(s.onload=s.onerror=this.defer(t,2e3)),s.src="http://hz.youku.com/red/click.php?"+o(r),L.info("Track:",e,s.src)}}},U={methods:{humanizeTime:function(e){/^\d+$/.test(e)&&(e=parseInt(e)),e=e.replace(" ","T");var t=((new Date).getTime()-new Date(e).getTime())/1e3;return isNaN(t)?"未知时间":60>t?"1分钟前":3600>t?parseInt(t/60)+"分钟前":86400>t?parseInt(t/3600)+"小时前":2592e3>t?parseInt(t/86400)+"天前":31536e3>t?parseInt(t/2592e3)+"个月前":parseInt(t/31536e3)+"年前"},humanizeDuration:function(e){e=parseFloat(e);var t=parseInt(e/60),n=parseInt(e)%60;return n=10>n?"0"+n:n,t=10>t?"0"+t:t,t+":"+n},humanizeNumber:function(e){return e=parseInt(e),1e4>e?e:1e8>e?parseInt(e/1e3)/10+"万":parseInt(e/1e7)/10+"亿"}}},X={login:function(e){var t=this;document.querySelector("#player video").pause(),login(function(){e&&e(),t.queue.forEach(function(e){e(!0)})})},logout:function(){login.logout(),this.queue.forEach(function(e){e(!1)})},onchange:function(e){this.queue=this.queue||[],this.queue.push(e)}},D={flash:function(e){this.flashComponent||(this.flashComponent=new H({el:"#app-flash-message"})),this.flashComponent.message=e}};e.M=D,Vue.mixin(U);var P={bootstrap:function(e,n){return t(location.hash.substring(1)).vid||(location.hash="#vid="+n[0].id),this.videos=n,this.vm=new Vue({el:e,data:function(){return{hash:location.hash,videos:n,launchable:j,auto:!1,weixin:v}},computed:{screen:function(){return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}},vid:function(){return t(this.hash.substring(1)).vid},video:function(){for(var e in this.videos){var t=this.videos[e];if(t.id==this.vid)return t}return void 0}},events:{playEnd:function(e){var t=0;for(this.auto=!0,console.log("End..",e);t<this.videos.length;t++)if(this.videos[t].id==e){t++;break}this.hash="#vid="+this.videos[t%this.videos.length].id},videoSelected:function(e){this.auto=!1,this.hash="#vid="+e},shareEvent:function(){this.$broadcast("shareEvent")},launchApp:function(){this.$broadcast("launchApp")}},methods:{followWeixin:function(){p(),R.t("weixinAccount",function(){location.href="http://mp.weixin.qq.com/s?__biz=MjM5OTIxNjA4MA==&mid=206335787&idx=1&sn=fd1e90d89cb1a12a8b175b561a5b1249#wechat_redirect"})}},watch:{hash:function(e){location.hash=e}},attached:function(){if(T){var e=this;r(function(t){e.launchable=t,R.launchable=t,R.t("pageReady")})}},ready:function(){T||(R.launchable=this.launchable,R.t("pageReady"))}}),this}};e.VueApp=P,Vue.component("downloader-component",{template:"#downloader-component",methods:{download:function(){p(),R.t("install",function(){p(!0),l()})}}}),Vue.component("player-component",{data:function(){return{playing:!1,loading:!0,playAfterReady:!1}},template:"#player-component",props:["vid","vv","videos","auto","playlistId"],attached:function(){var t=this;e._xxx_console=e.console,require("http://static.youku.com/h5/player/embed/unifull/unifull_.js",function(){e.console=e._xxx_console,t.setup()}),document.querySelector("#player").addEventListener("click",function(e){R.t("play")}),X.onchange(function(){$("#player").css({visibility:"visible"})})},methods:{setup:function(){var e=this;B.defaultConfig={playlistconfig:{aid:e.playlistId,Type:"Folder"},vvlogconfig:{plid:e.playlistId,get url(){return encodeURIComponent(location.href)}},events:{onPlayStart:function(){e.playing=!0,$("#player").removeClass("hide-title")},onPlayEnd:function(){e.$dispatch("playEnd",e.vid)},onPlayerReady:function(){e.loading=!1,e.playAfterReady&&B.player.startPlayVideo()}}},B.create(this.vid),$("#player").addClass("hide-title"),this.loading=!1}},watch:{vid:function(t){e.scrollTo(0,0),this.auto?B.player.playVideoById(this.vid):this.playAfterReady=!0}},computed:{screen:{width:function(){return e.innerWidth},height:function(){return e.innerHeight}}}}),Vue.component("videolist-component",{data:function(){return{limit:10,expand:!1}},props:["videos","current"],computed:{limited:function(){for(var e=0;e<this.videos.length&&this.videos[e].id!=this.current;e++);return this.expand=this.expand||e>this.limit||this.videos.length<this.limit,!this.expand}},template:"#video-list-component",methods:{loadMore:function(){this.expand=!0,R.t("viewAllVideos")}},attached:function(){var e=this;$(this.$el).on("click",function(t){var n=$(t.target);n.hasClass("bd-video-list-item")||(n=n.parents(".bd-video-list-item")),n.hasClass("bd-play-current")||(R.t("nextVideo"),B.create(n.data("vid"),!0),e.$dispatch("videoSelected",n.data("vid")))})}});var Q={key:"_h5_app_launcher_ios9_timestamp",save:function(){localStorage.setItem(this.key,(new Date).getTime())},restore:function(){return parseInt(localStorage.getItem(this.key)||0)},failed:function(){return I&&(new Date).getTime()-this.restore()<=5e3},clear:function(){localStorage.removeItem(this.key)}};e._ExternalPromptDownload=!0,Vue.component("launch-component",{template:"#launch-component",props:["vid","playlistId"],data:function(){var e=Q.failed();return Q.clear(),{opening:e,failed:e}},events:{launchApp:function(){this.launch()}},methods:{download:function(){this.opening=!1,l()},directLaunch:function(){R.t("launchXXL"),this.launch()},launch:function(){this.failed=!1,this.opening=!0;var e=this,t=new Launcher({yingyongbaoCallback:function(){location.href="http://a.app.qq.com/o/simple.jsp?pkgname=com.youku.phone&g_f=992258"},universalLink:v?"":"http://link-jump.youku.com/a/",webSocketEnabled:!v&&x}),i={vid:this.vid,playlist_id:u(this.playlistId,"P"),source:"mplaypage10"};if(C)t.launch(i),setTimeout(function(){e.opening=!1},2e3);else{n(i,a()),t._track(i);var e=this;s(i,function(){e.opening=!1},function(){e.failed=!0})}}}}),Vue.component("share-component",{template:"#share-component",methods:{share:function(){R.t("shareXXL"),this.$dispatch("shareEvent")}}}),Vue.component("sharecard-component",{template:"#sharecard-component",data:function(){return{opened:!1,weixin:v||w||g||k,wechatShowHint:!1}},props:["title","desc","coverImage","author","total"],attached:function(){if(this.desc=["该播单由",this.author,"创建，","共包含",this.total,"个精彩视频，快来看看吧～"].join(""),this.weixin){var e={title:this.title,desc:this.desc};this.coverImage&&(e.img_url=this.coverImage);var t="undefined"!=typeof WeixinJSBridge,n=function(){WeixinJSBridge.on("menu:share:timeline",function(){h(!1,e)}),WeixinJSBridge.on("menu:share:appmessage",function(){h(!0,e)})};t?n():document.addEventListener("WeixinJSBridgeReady",n)}},methods:{share:function(e){var t={qq:{link:"http://connect.qq.com/widget/shareqq/index.html",params:{summary:this.desc,title:this.title,pics:this.coverImage,url:location.href}},weibo:{link:"http://v.t.sina.com.cn/share/share.php",params:{appkey:2684493555,url:location.href,title:this.title,source:"优酷网",sourceUrl:"http://www.youku.com",content:"utf8",searchPic:!1}},qzone:{link:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey",params:{url:location.href,style:203,title:this.title,summary:this.desc,pics:this.coverImage}}};return"weixin"==e?(this.wechatShowHint=!0,void R.t("shareWeixin")):(this.close(),p(),void R.t({qq:"shareQQ",weibo:"shareWeibo",qzone:"shareQZone"}[e],function(){p(!0),location.href=t[e].link+"?"+o(t[e].params)}))},close:function(){this.opened=!1;var e=this;setTimeout(function(){e.wechatShowHint=!1},1e3)}},events:{shareEvent:function(){this.opened=!0}},watch:{opened:function(e){d(!e)}}}),Vue.component("infocard-component",{template:"#infocard-component",data:function(){return{liked:!1,apiOk:!1}},props:["title","desc","cover","author","playlistId","creationTime","userId","launchable"],computed:{linebreak:function(){return this.title.length>12}},attached:function(){var e=this;this.refresh(),X.onchange(function(){e.refresh()})},methods:{refresh:function(){var e=this;this.liked=!1,require("http://static.youku.com/pl-static/h5/app.js",function(){e.apiOk=!0,require("http://static.youku.com/v1.0.1083/index/js/mlogin.js",function(){login.islogin()&&BDApi.followed(e.playlistId).success(function(t){e.liked=t.ok&&t.result.followed})})})},jump:function(){R.t("visitUser")},encodeUser:function(e){return u(e,"U")},share:function(){R.t("shareXXS"),this.$dispatch("shareEvent")},like:function(){if(!this.apiOk)return void D.flash("出错了，请刷新页面重试...");R.t("follow");var e=this;return login.islogin()?void(this.liked?BDApi.unfollow(this.playlistId).success(function(t){e.liked=!1}).fail(function(e){D.flash("失败了，一会儿再试试？")}):BDApi.follow(this.playlistId).success(function(t){e.liked=!0,R.t("followSuccess"),D.flash("已关注播单，可在优酷App个人中心我的播单查看已关注的播单哟～")}).fail(function(e){D.flash("失败了，一会儿再试试？")})):void X.login(function(){})}}}),Vue.component("comments-component",{template:"#comments-component",props:["vid","launchable"],data:function(){return{comments:[],size:5,all:13,page:1,loading:!0,error:!1,avatar:"",loggedIn:!1,dialogOpened:!1,message:"",limit:300,sent:!1}},computed:{remains:function(){return this.limit-this.message.length},more:function(){return this.page*this.size-2<this.comments.length},visible:function(){return Math.min(this.all,this.page*this.size-2)}},attached:function(){this.fetch();var e=this;this.refresh(),X.onchange(function(){e.refresh()})},methods:{refresh:function(){var e=this;require("http://static.youku.com/v1.0.1083/index/js/mlogin.js",function(){login.islogin()&&(e.loggedIn=!0,$.ajax({url:"http://nc.youku.com/index_MHeaderJSONP?function[]=userinfo",dataType:"jsonp",jsonp:"callback[]",success:function(t){if("null"!=t){var n=document.createElement("div");n.innerHTML=t,e.avatar=n.querySelector(".yk-userlog-avatar img").src}}}))})},launch:function(){R.t("launchComments"),this.$dispatch("launchApp")},showMore:function(){R.t(["viewComments1","viewComments2"][this.page-1]),this.page=this.page+1},openCommentDialog:function(){if(R.t("writeComment"),this.loggedIn)return void(this.dialogOpened=!0);var e=this;X.login(function(){e.loggedIn=!0,e.dialogOpened=!0})},sendComment:function(e){if(e){var t=this;$.ajax({url:"http://v.youku.com/x_commentsSubmit",dataType:"jsonp",data:{videoId:this.vid,content:e},complete:function(){R.t("writeCommentSuccess"),t.sent=!0,t.message=""}})}},close:function(){this.dialogOpened=!1},fetch:function(){var e=this;this.error=!1,this.loading=!0,this.page=1,this.comments=[],$.ajax({url:"http://v.youku.com/x_getWechatComment",dataType:"jsonp",data:{vid:c(this.vid),ver:"v6"},success:function(t){e.comments=m(t,e.all),e.loading=!1},error:function(t){e.error=!0,e.loading=!1}})},touchMoved:function(e){console.log(e)}},watch:{vid:function(){this.message="",this.fetch()},message:function(){this.message.length>this.limit&&(this.message=this.message.substring(0,this.limit),$("textarea.comment-textarea").val(this.message))},dialogOpened:function(e){if(!e){var t=this;setTimeout(function(){t.sent=!1},1e3)}x&&(e?(document.querySelector("#player video").pause(),$("#player").css({visibility:"hidden"})):$("#player").css({visibility:"visible"})),q&&(e?$("html").addClass("lock"):$("html").removeClass("lock"))}}}),Vue.component("loading-component",{template:"#loading-component"});var H=Vue.component("flash-component",{template:"#flash-component",data:function(){return{message:""}},computed:{duration:function(){return 3e3}},watch:{message:function(e){if(e){var t=this;setTimeout(function(){t.message=""},this.duration)}}}})}(window);
